!function(e,n){"object"==typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Templatize=n()}(this,function(){return String.prototype.endsWith||(String.prototype.endsWith=function(e,n){return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e}),{errorOnFuncFailure:!1,__objTester:{}.toString,render:function(e,n,t){var r=this.__render(e,n);if(t)for(var i=r.indexOf("{{");~i;){var l=r.indexOf("}}",i);if(!~l)break;i=(r=r.slice(0,i)+r.slice(l+2)).indexOf("{{")}return r},__render:function(e,n,t){if(!e)return"";var r=null!=t;if(r){var i=!("_display"in n)||n._display;e=this.__renderSection(e,t,i)}for(var l in t=r?t+".":"",n)if("_display"!==l&&"_parent"!==l){var c=n[l];if(c)switch(this.__objTester.call(c)){case"[object Object]":c._parent||(c._parent=n),e=this.__render(e,c,t+l),delete c._parent;continue;case"[object Array]":c._parent||(c._parent=n),e=this.__renderRepeatingSection(e,l,c,t),delete c._parent;continue;case"[object Function]":try{c=c.call(n)}catch(e){if(this.errorOnFuncFailure)throw e;c=""}}var o=t+l;e=(e=this.__renderSection(e,o,c)).replace(new RegExp("{{"+o+"}}","g"),c)}return e},__renderSection:function(e,n,t){t=0===t||t&&("string"!=typeof t||t.trim().length);for(var r="{{#"+n+"}}",i="{{^"+n+"}}",l="{{/"+n+"}}",c=0,o=r.length+l.length;!(e.length<o||c&&c+1>=e.length);){var a=e.indexOf(r,c),s=e.indexOf(i,c),_=~a&&(!~s||a<s),d=_?a:s,f=!!~d&&e.indexOf(l,d);if(!1===f||!~f)break;c=(t?_:!_)?(e=e.slice(0,d)+e.slice(d+l.length,f)+e.slice(f+l.length),f-l.length):(e=0===d?e.slice(f+l.length):e.slice(0,d)+e.slice(f+l.length),d)}return e},__renderRepeatingSection:function(e,n,t,r){var i="{{#"+(n=r?r+(r.endsWith(".")?"":".")+n:n)+"}}",l="{{/"+n+"}}",c=e.indexOf(i),o=!!~c&&e.indexOf(l,c);if(!1===o||!~o)return e;for(var a=e.substring(c+i.length,o),s="",_=0;_<t.length;++_)t[_]._parent||(t[_]._parent=t._parent),s+=this.__render(a,t[_],n),delete t[_]._parent;return 0===c?s+e.slice(o+l.length):e.slice(0,c)+s+e.slice(o+l.length)}}});