!function(e,n){"object"==typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Templatize=n()}(this,function(){return{errorOnFuncFailure:!1,__objTester:{}.toString,render:function(e,n,r){var t=this.__render(e,n);if(r)for(var i=t.indexOf("{{");~i;){var c=t.indexOf("}}",i);if(!~c)break;i=(t=t.slice(0,i)+t.slice(c+2)).indexOf("{{")}return t},__render:function(e,n,r){if(!e)return"";var t=null!=r;if(t){var i=!("_display"in n)||n._display;e=this.__renderSection(e,r,i)}for(var c in r=t?r+".":"",n)if("_display"!==c&&"_parent"!==c){var l=n[c];if(l)switch(this.__objTester.call(l)){case"[object Object]":l._parent||(l._parent=n),e=this.__render(e,l,r+c);continue;case"[object Array]":l._parent||(l._parent=n),e=this.__renderRepeatingSection(e,c,l,r);continue;case"[object Function]":try{l=l.call(n)}catch(e){if(this.errorOnFuncFailure)throw e;l=""}}var o=r+c;e=(e=this.__renderSection(e,o,l)).replace(new RegExp("{{"+o+"}}","g"),l)}return e},__renderSection:function(e,n,r){r=0===r||r&&("string"!=typeof r||r.trim().length);for(var t="{{#"+n+"}}",i="{{^"+n+"}}",c="{{/"+n+"}}",l=0,o=t.length+c.length;!(e.length<o||l&&l+1>=e.length);){var a=e.indexOf(t,l),f=e.indexOf(i,l),s=~a&&(!~f||a<f),_=s?a:f,d=!!~_&&e.indexOf(c,_);if(!1===d||!~d)break;l=(r?s:!s)?(e=e.slice(0,_)+e.slice(_+c.length,d)+e.slice(d+c.length),d-c.length):(e=0===_?e.slice(d+c.length):e.slice(0,_)+e.slice(d+c.length),_)}return e},__renderRepeatingSection:function(e,n,r,t){t=t?t+"."+n:n;var i="{{#"+n+"}}",c="{{/"+n+"}}",l=e.indexOf(i),o=!!~l&&e.indexOf(c,l);if(!1===o||!~o)return e;for(var a=e.substring(l+i.length,o),f="",s=0;s<r.length;++s)f+=this.__render(a,r[s],t);return 0===l?f+e.slice(o+c.length):e.slice(0,l)+f+e.slice(o+c.length)}}});